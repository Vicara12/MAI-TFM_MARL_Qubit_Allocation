Parameters:

self.fc1 = torch.nn.Sequential(
  torch.nn.Linear(256,256),
  torch.nn.ReLU(),
  torch.nn.Linear(256,64),
  torch.nn.ReLU()
)
self.fc2 = torch.nn.Sequential(
  torch.nn.Linear(512,512),
  torch.nn.ReLU(),
  torch.nn.Linear(512,128+64),
  torch.nn.ReLU()
)
self.fc = torch.nn.Sequential(
  torch.nn.Linear(256,256),
  torch.nn.ReLU(),
  torch.nn.Linear(256,128),
  torch.nn.ReLU(),
  torch.nn.Linear(128,64),
  torch.nn.ReLU()
)
self.fc_v = torch.nn.Linear(64,1)

is_model = InferenceServer(model_cfg=InferenceServer.ModelCfg(
    name="model",
    model=SimpleModel(),
    supports_batch=True,
    max_batch_size=16,
    parameters={'x0': (True, (x0_size,)), 'x1': (True, (x1_size,)), 'flag': (False,)},
    flexible_input_size=False
  )
)

test_correctness(64, 128)

========== Initial:

time_per_thread = [14.018287897109985, 14.55872917175293, 14.362685441970825, 14.532490968704224, 13.771610736846924, 14.457987070083618, 14.353253602981567, 14.155555963516235, 14.204750537872314, 13.970747470855713, 14.28754448890686, 13.895885944366455, 14.141015768051147, 14.013755559921265, 14.330149173736572, 14.093396425247192, 14.473271608352661, 14.776997804641724, 14.937366485595703, 14.339544773101807, 14.581403255462646, 13.953235387802124, 14.247369766235352, 14.658315896987915, 13.691039085388184, 14.108351707458496, 14.088045358657837, 14.13974118232727, 13.842779874801636, 14.196374654769897, 14.030343055725098, 14.374779224395752, 13.828226327896118, 14.33785605430603, 14.034747123718262, 14.076260566711426, 14.662170886993408, 13.92592477798462, 14.248944282531738, 14.160449981689453, 14.05098295211792, 13.870979309082031, 14.269037246704102, 14.104698419570923, 15.103329420089722, 14.25337266921997, 14.328578472137451, 14.5957932472229, 14.123733758926392, 14.93649673461914, 14.34825849533081, 13.85336685180664, 14.627918004989624, 14.534444570541382, 14.348913192749023, 13.674868822097778, 14.364604234695435, 14.164468765258789, 14.189770936965942, 15.811474323272705, 14.537896156311035, 14.908853530883789, 13.984012842178345, 14.355003118515015]
mean_time = 14.284410022199154
batch_performance = [0, 146, 0, 3, 1, 9, 7, 12, 13, 23, 30, 31, 42, 39, 34, 33, 308]



========== GPU:

time_per_thread = [36.88138484954834, 37.880035638809204, 38.971930742263794, 37.660123348236084, 37.70449352264404, 37.5445921421051, 36.9428825378418, 37.96578359603882, 37.64365291595459, 37.12501764297485, 37.999059200286865, 37.89413666725159, 37.35610818862915, 37.68202209472656, 38.69406509399414, 37.859110832214355, 36.96011257171631, 37.26880097389221, 36.879557609558105, 38.51015090942383, 38.59541583061218, 37.95428538322449, 38.36242461204529, 37.62344217300415, 37.480210304260254, 37.08434319496155, 37.69742774963379, 38.19948077201843, 38.30914807319641, 37.55721950531006, 38.66279172897339, 37.50310659408569, 37.68285298347473, 38.15773367881775, 37.896369218826294, 38.4283926486969, 37.869086503982544, 37.4000883102417, 37.795923709869385, 38.0470187664032, 37.74063324928284, 37.99704837799072, 37.988032579422, 38.33733606338501, 38.10989737510681, 37.53198170661926, 38.14543700218201, 38.43092346191406, 36.77281141281128, 37.686100244522095, 37.402735471725464, 37.641618490219116, 37.29489612579346, 38.206480979919434, 37.81797957420349, 38.04355788230896, 37.19483017921448, 37.994133710861206, 37.47318625450134, 39.30819821357727, 37.46727204322815, 37.33231973648071, 38.10534048080444, 37.32863998413086]
mean_time = 37.798143334686756
batch_performance = [7, 75, 412, 612, 445, 185, 71, 24, 8, 5, 1, 3, 3, 3, 3, 2, 0]